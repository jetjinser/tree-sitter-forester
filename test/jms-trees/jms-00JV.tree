\title{the [adjacency matrix](jms-00JN) of the [reflexive-transitive closure](jms-00JH)}
\date{2024-01-21}
\author{jonmsterling}
\contributor{marcelofiore}
\taxon{algorithm}
\import{jms-00JB}

\p{Let #{M = \matrix-of-rel_{\mathbb{B}}R} be the [adjacency matrix](jms-00JN) of a  finite [directed graph](jms-00JC) \prn{\brk{n},R}. We will show that the [adjacency matrix](jms-00JN) #{M^*} of the [reflexive-transitive closure](jms-00JH) #{R^{\circ*}} can be computed recursively using the [additive](jms-00JS) and [multiplicative](jms-00IW) structure of [matrices](jms-00IS). In particular, we can define #{M^* = M_n} where #{M_k} is computed recursively as below:}

##{
 \begin{aligned}
   M_0 &= I^n\\
   M_{k+1} &= I^n + \prn{M\cdot M_k}
 \end{aligned}
}

\p{Thus we have a recursive algorithm that can deicde whether there is a path between two elemetns in a finite [directed graph](jms-00JC): indeed, there is a path from #{s} to #{t} in #{R} if and only if #{M^*_{s,t} =\true}.}

\proof{
 \p{We first unravel the first few \nowrap{#{M_k}â€™s} to get a better understanding.}

 ##{
  \begin{aligned}
   M_1 &= I^n + M\cdot M_0
   \\
   &= I^n+M\cdot I^n
   \\
   &= I^n + M
   \\
   M_2 &= I^n + M\cdot M_1
   \\
   &= I^n + M\cdot (I^n + M)
   \\
   &= I^n + M\cdot I^n + M\cdot M
   \\
   &= I^n + M + M^2
  \end{aligned}
 }

 \p{By induction, we can extend the pattern above to a closed form for each #{M_k}. In particular, we deduce that #{M_k = \sum_{l\leq k} M^l} by recalling from \ref{jms-00J3} that the [identity matrix](jms-00IT) is the neutral element for [matrix multiplication](jms-00IV). Therefore, we have #{M_n =\sum_{k \leq n}M^k}.}

 \p{Our goal is to show that #{M_n = \matrix-of-rel_{\mathbb{B}} R^{\circ *}}; we have already seen in \ref{jms-00JR} and \ref{jms-00J2} that [matrix addition](jms-00JO) corresponds to union of [relations](jms-00I7) and [matrix multiplication](jms-00IV) corresponds to [relational composition](jms-00IN).}

 \p{By \ref{jms-00JU} ([[jms-00JU]]), we have #{R^{\circ*} = \bigcup_{k\leq n} R^{\circ k}}. Therefore:}

 ##{
  \matrix-of-rel_{\mathbb{B}}R^{\circ*} = \matrix-of-rel_{\mathbb{B}}\bigcup_{k\leq n} R^{\circ k}
 }

 \p{By \ref{jms-00JR} ([[jms-00JR]]), we have:}

 ##{
  \matrix-of-rel_{\mathbb{B}}\bigcup_{k\leq n} R^{\circ k}
  =
  \sum_{k\leq n} \matrix-of-rel_{\mathbb{B}}R^{\circ k}
 }

 By \ref{jms-00J2} ([[jms-00J2]]), we have:
 ##{
  \sum_{k\leq n} \matrix-of-rel_{\mathbb{B}}R^{\circ k}  =
  \sum_{k\leq n} \prn{\matrix-of-rel_{\mathbb{B}}R}^k
  =
  \sum_{k\leq n} M^k
  = M_n
 }
}